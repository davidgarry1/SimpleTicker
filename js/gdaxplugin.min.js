function w(){function t(){o(),e(),a()}function e(){$(window).resize(function(){l()}),$("#candle").click(function(){f="candle",$("#activechart").html("Chart: Candlestick"),l(),setCookie("CHART_TYPE","candle")}),$("#line").click(function(){f="line",$("#activechart").html("Chart: Line"),l(),setCookie("CHART_TYPE","line")}),$("#combo").click(function(){f="both",$("#activechart").html("Chart: Combo"),l(),setCookie("CHART_TYPE","both")}),$("#hour").click(function(){I=d,$("#activet").html("Interval: 1 Hour"),$("span.interval").html("1H"),l(),setCookie("GRANULARITY",d)}),$("#day").click(function(){I=b,$("#activet").html("Interval: 1 Day"),$("span.interval").html("1D"),l(),setCookie("GRANULARITY",b)}),$("#week").click(function(){I=y,$("#activet").html("Interval: 1 Week"),$("span.interval").html("1W"),l(),setCookie("GRANULARITY",y)}),$("#month").click(function(){I=A,$("#activet").html("Interval: 1 Month"),$("span.interval").html("1M"),l(),setCookie("GRANULARITY",A)}),$("#year").click(function(){I=R,$("#activet").html("Interval: 1 Year"),$("span.interval").html("1Y"),l(),setCookie("GRANULARITY",R)}),$("#alltime").click(function(){I=U,$("#activet").html("Interval: All Time"),$("span.interval").html("ALL"),l(),setCookie("GRANULARITY",U)}),$("#cusd").click(function(){k="USD",$("#activec").html(k),a(),setCookie("HOME_CURRENCY","USD")}),$("#ceur").click(function(){k="EUR",$("#activec").html(k),a(),setCookie("HOME_CURRENCY","EUR")}),$("#cgbp").click(function(){k="GBP",$("#activec").html(k),a(),setCookie("HOME_CURRENCY","GBP")}),$("#tabbtc").click(function(){T="BTC",$("#activetab").html("Tab: "+T),document.title=$("#"+T.toLowerCase()+"price").html()+"-"+T+" | Simple Ticker",setCookie("ACTIVE_TAB","BTC")}),$("#tabeth").click(function(){T="ETH",$("#activetab").html("Tab: "+T),document.title=$("#"+T.toLowerCase()+"price").html()+"-"+T+" | Simple Ticker",setCookie("ACTIVE_TAB","ETH")}),$("#tabltc").click(function(){T="LTC",$("#activetab").html("Tab: "+T),document.title=$("#"+T.toLowerCase()+"price").html()+"-"+T+" | Simple Ticker",setCookie("ACTIVE_TAB","LTC")})}function o(){hasCookie("GRANULARITY")&&(I=getCookie("GRANULARITY"),I==d?($("#activet").html("Interval: 1 Hour"),$("span.interval").html("1H")):I==b?($("#activet").html("Interval: 1 Day"),$("span.interval").html("1D")):I==y?($("#activet").html("Interval: 1 Week"),$("span.interval").html("1W")):I==A?($("#activet").html("Interval: 1 Month"),$("span.interval").html("1M")):I==R?($("#activet").html("Interval: 1 Year"),$("span.interval").html("1Y")):I==U&&($("#activet").html("Interval: All Time"),$("span.interval").html("ALL"))),hasCookie("ACTIVE_TAB")&&(T=getCookie("ACTIVE_TAB")),hasCookie("HOME_CURRENCY")&&(k=getCookie("HOME_CURRENCY"),$("#activec").html(k)),hasCookie("CHART_TYPE")&&(f=getCookie("CHART_TYPE"),"candle"==f?$("#activechart").html("Chart: Candlestick"):"line"==f?$("#activechart").html("Chart: Line"):"both"==f&&$("#activechart").html("Chart: Combo"))}function a(){l(),i()}function i(){clearInterval(p),n(!0),p=setInterval(function(){n(!1)},g)}function l(){clearInterval(C),s(!0),C=setInterval(function(){s(!1)},v)}function r(t,e){var o=2;"ltc"!=t&&"eth"!=t||"GBP"!=e||(e="BTC",o=7),$.getJSON("https://api.gdax.com/products/"+t+"-"+e+"/ticker",function(a){var i=new Intl.NumberFormat("en-US",{style:"currency",currency:e,minimumFractionDigits:o,maximumFractionDigits:o});$("#"+t+"price").html(i.format(a.price)),t.toUpperCase()==T&&(document.title=i.format(a.price)+"-"+t.toUpperCase()+" | Simple Ticker")}).fail(function(){console.log("Too many requests to GDAX API")})}function c(t,e){$("#"+t).removeClass("red"),$("#"+t).removeClass("green"),e>=0?$("#"+t).addClass("green"):$("#"+t).addClass("red")}function n(t){times=1,t&&(times=3);for(var e=0;e<times;e++)++u>3&&(u=1),1==u?r("btc",k):2==u?r("eth",k):r("ltc",k)}function s(t){h("btc",k,t),h("eth",k,t),h("ltc",k,t)}function m(t,e){var o=$("#"+t+"price").text().replace(/[^0-9\.-]+/g,"");if("..."!=o){var a=Number(o)/e-1;$("#"+t+"open").html(D.format(a)),c(t+"price",a),c(t+"open",a)}else E[t]&&(E[t]=!1,setTimeout(function(){E[t]=!0,m(t,e)},100))}function h(t,e,o){o&&(document.getElementById(t+"chart").innerHTML=" Loading...",$("#"+t+"open").html("..."),$("#"+t+"high").html("..."),$("#"+t+"low").html("..."),$("#"+t+"open").removeClass("red"),$("#"+t+"open").removeClass("green"));var a=2;"ltc"!=t&&"eth"!=t||"GBP"!=e||(e="BTC",a=7);var i;I==d?i="https://min-api.cryptocompare.com/data/histominute?fsym="+t.toUpperCase()+"&tsym="+e.toUpperCase()+"&limit=60&aggregate=1&e=GDAX":I==b?i="https://min-api.cryptocompare.com/data/histominute?fsym="+t.toUpperCase()+"&tsym="+e.toUpperCase()+"&limit=72&aggregate=20&e=GDAX":I==y?i="https://min-api.cryptocompare.com/data/histohour?fsym="+t.toUpperCase()+"&tsym="+e.toUpperCase()+"&limit=84&aggregate=2&e=GDAX":I==A?i="https://min-api.cryptocompare.com/data/histohour?fsym="+t.toUpperCase()+"&tsym="+e.toUpperCase()+"&limit=72&aggregate=10&e=GDAX":I==R?i="https://min-api.cryptocompare.com/data/histoday?fsym="+t.toUpperCase()+"&tsym="+e.toUpperCase()+"&limit=73&aggregate=5&e=GDAX":I==U&&(i="https://min-api.cryptocompare.com/data/histoday?fsym="+t.toUpperCase()+"&tsym="+e.toUpperCase()+"&limit=75&aggregate=16&e=GDAX"),$.getJSON(i,function(o){if("Success"!=o.Response)return void console.log("Chart API Call Failed: "+o.Response);var i=Math.max(10,7500/$(document).width()),l=new Intl.NumberFormat("en-US",{style:"currency",currency:e,minimumFractionDigits:a,maximumFractionDigits:a});console.log("Rendering "+t.toUpperCase()+"-"+e.toUpperCase());var r=[];"both"==f?r[0]=["Date","Low","Open","Close","High","Tooltip","Close"]:"candle"==f?r[0]=["Date","Low","Open","Close","High","Tooltip"]:"line"==f&&(r[0]=["Date","Close"]);var c,n;n=o.Data[0].low,c=o.Data[0].high;for(var s=1;s<1+o.Data.length;s++){var h=o.Data[s-1].time,p=o.Data[s-1].low;n=Math.min(n,p);var C=o.Data[s-1].high;c=Math.max(c,C);var g=o.Data[s-1].open,v=o.Data[s-1].close;o.Data[s-1].volumeto;"both"==f?r[s]=[0,0,0,0,0,0,0]:"candle"==f?r[s]=[0,0,0,0,0,0]:"line"==f&&(r[s]=[0,0]),r[s][0]=new Date(1e3*h),"both"==f||"candle"==f?(r[s][1]=p,r[s][2]=g,r[s][3]=v,r[s][4]=C,r[s][5]=r[s][0].toLocaleString()+": "+l.format(r[s][3]),"both"==f&&(r[s][6]=v)):"line"==f&&(r[s][1]=v)}$("#"+t+"high").html(l.format(c)),$("#"+t+"low").html(l.format(n));var u;"USD"==e?u="$#,###.##":"EUR"==e?u="€#,###.##":"GBP"==e?u="£#,###.##":"BTC"==e&&(u="BTC#,###.#######");var k=google.visualization.arrayToDataTable(r,!1);if("both"==f||"candle"==f){k.setColumnProperty(5,"role","tooltip");var T={legend:"none",bar:{groupWidth:"100%"},colors:["lightgrey","#4c77b2"],candlestick:{fallingColor:{stroke:"black",strokeWidth:0,fill:"red"},risingColor:{stroke:"black",strokeWidth:0,fill:"green"}},chartArea:{left:i+"%",bottom:"10%",width:100-i-1+"%",height:"85%"},vAxis:{titleTextStyle:{color:"black"},gridlines:{color:"lightgrey"},textStyle:{color:"black"},titleTextStyle:{color:"black"},format:u},backgroundColor:"white",titleTextStyle:{color:"black"},fontName:"Consolas",hAxis:{logscale:!1,textStyle:{color:"black"},titleTextStyle:{color:"black"},gridlines:{color:"lightgrey",count:4},showTextEvery:1},crosshair:{trigger:"both"},seriesType:"candlesticks",series:{1:{type:"area"}}}}else if("line"==f)var T={legend:"none",bar:{groupWidth:"100%"},colors:["#4c77b2"],candlestick:{fallingColor:{stroke:"black",strokeWidth:0,fill:"red"},risingColor:{stroke:"black",strokeWidth:0,fill:"green"}},chartArea:{left:i+"%",bottom:"10%",width:100-i-1+"%",height:"85%"},vAxis:{titleTextStyle:{color:"black"},gridlines:{color:"lightgrey"},textStyle:{color:"black"},titleTextStyle:{color:"black"},format:u},backgroundColor:"white",titleTextStyle:{color:"black"},fontName:"Consolas",hAxis:{logscale:!1,textStyle:{color:"black"},titleTextStyle:{color:"black"},gridlines:{color:"lightgrey",count:4},showTextEvery:1},crosshair:{trigger:"both"},seriesType:"area"};var d=new google.visualization.ComboChart(document.getElementById(t+"chart"));d.draw(k,T),m(t,o.Data[0].open)}).fail(function(){console.log("CHART API Call Failure")})}var p,C,g=1300,v=6e4,u=0,k="USD",f="line",T="BTC",d=1,b=2,y=3,A=4,R=5,U=6,I=d,D=new Intl.NumberFormat("percent",{style:"percent",minimumFractionDigits:3,maximumFractionDigits:3}),E=JSON.parse("{}");E.btc=!0,E.ltc=!0,E.eth=!0,google.charts.setOnLoadCallback(function(){t()})}w();
